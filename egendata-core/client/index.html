<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.58.3" />
    <meta name="description" content="">


    <link rel="shortcut icon" href="//egendata.github.io/docs/images/egendata.png" type="image/x-icon" />
    <title>Client :: Egendata documentation</title>

    
    <link href="/docs/css/nucleus.css?1595422117" rel="stylesheet">
    <link href="/docs/css/fontawesome-all.min.css?1595422117" rel="stylesheet">
    <link href="/docs/css/hybrid.css?1595422117" rel="stylesheet">
    <link href="/docs/css/featherlight.min.css?1595422117" rel="stylesheet">
    <link href="/docs/css/perfect-scrollbar.min.css?1595422117" rel="stylesheet">
    <link href="/docs/css/auto-complete.css?1595422117" rel="stylesheet">
    <link href="/docs/css/atom-one-dark-reasonable.css?1595422117" rel="stylesheet">
    <link href="/docs/css/theme.css?1595422117" rel="stylesheet">
    <link href="/docs/css/hugo-theme.css?1595422117" rel="stylesheet">
    
      <link href="/docs/css/theme-mine.css?1595422117" rel="stylesheet">
    

    <script src="/docs/js/jquery-3.3.1.min.js?1595422117"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
  </head>
  <body class="" data-url="/docs/egendata-core/client/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="//egendata.github.io/docs">
  <img alt="Egendata" src="//egendata.github.io/docs/images/egendata.png" />
</a>
    </div>
    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/docs/architecture/" title="Architecture" class="dd-item 
        
        
        
        ">
      <a href="/docs/architecture/">
          Architecture
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/docs/cryptography/" title="Cryptography" class="dd-item 
        
        
        
        ">
      <a href="/docs/cryptography/">
          Cryptography
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/docs/egendata-core/" title="Egendata Core" class="dd-item 
        parent
        
        
        ">
      <a href="/docs/egendata-core/">
          Egendata Core
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/docs/egendata-core/client/" title="Client" class="dd-item 
        parent
        active
        
        ">
      <a href="/docs/egendata-core/client/">
          Client
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/egendata-core/data/" title="Data" class="dd-item 
        
        
        
        ">
      <a href="/docs/egendata-core/data/">
          Data
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/docs/egendata-core/data/messages/" title="Messages" class="dd-item ">
        <a href="/docs/egendata-core/data/messages/">
        Messages
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/egendata-core/security/" title="Security" class="dd-item 
        
        
        
        ">
      <a href="/docs/egendata-core/security/">
          Security
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/egendata-core/services/" title="Services" class="dd-item 
        
        
        
        ">
      <a href="/docs/egendata-core/services/">
          Services
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/docs/infrastructure/" title="Infrastructure" class="dd-item 
        
        
        
        ">
      <a href="/docs/infrastructure/">
          Infrastructure
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/docs/infrastructure/cli/" title="cli" class="dd-item 
        
        
        
        ">
      <a href="/docs/infrastructure/cli/">
          cli
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/infrastructure/client/" title="client" class="dd-item 
        
        
        
        ">
      <a href="/docs/infrastructure/client/">
          client
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/infrastructure/example-cv/" title="Example-CV" class="dd-item 
        
        
        
        ">
      <a href="/docs/infrastructure/example-cv/">
          Example-CV
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/infrastructure/example-national-registration/" title="Example-National-Registration" class="dd-item 
        
        
        
        ">
      <a href="/docs/infrastructure/example-national-registration/">
          Example-National-Registration
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/infrastructure/messaging/" title="messaging" class="dd-item 
        
        
        
        ">
      <a href="/docs/infrastructure/messaging/">
          messaging
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/infrastructure/operator/" title="Operator" class="dd-item 
        
        
        
        ">
      <a href="/docs/infrastructure/operator/">
          Operator
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/docs/infrastructure/react-native-simple-crypto/" title="react-native-simple-crypto" class="dd-item 
        
        
        
        ">
      <a href="/docs/infrastructure/react-native-simple-crypto/">
          react-native-simple-crypto
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/docs/phone-app/" title="Mobile App" class="dd-item 
        
        
        
        ">
      <a href="/docs/phone-app/">
          Mobile App
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/docs/operator/" title="Operator" class="dd-item 
        
        
        
        ">
      <a href="/docs/operator/">
          Operator
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/docs/'>Introduction</a> > <a href='/docs/egendata-core/'>Egendata Core</a> > Client
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#usage">Usage</a></li>
<li><a href="#client-configuration-properties">Client configuration properties</a></li>
<li><a href="#key-provider">Key Provider</a></li>
<li><a href="#key-value-store">Key Value Store</a>
<ul>
<li><a href="#interface-definition">Interface definition</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Client
            </h1>
          

        




	

<p>The Client library serves to alleviate the Egendata integration complexity for <a href="#">Service</a> providers.</p>

<p>For reference, the following example sites utilize the Client library:</p>

<ul>
<li><a href="https://github.com/egendata/example-cv">Example CV</a></li>
<li><a href="https://github.com/JobtechSwe/myskills-api">MySkills API</a></li>
</ul>

<h2 id="usage">Usage</h2>

<p>The Client library is distributed via the NPM software registry and can be installed with:</p>

<pre><code class="language-bash">npm install @egendata/client
</code></pre>

<p>Import and start using the Client library:</p>

<pre><code class="language-js">const client = require('@egendata/client');

// A key-value based storage module that implements the required interface methods listed below:
//   * keyValueStore.save(key, value, ttl)
//   * keyValueStore.load(key)
//   * keyValueStore.remove(key)
const keyValueStore = require('../services/keyValueStore')

// An example Client configuration
const config = {
  displayName: 'My service',
  description: 'A service that integrates with Egendata',
  iconURI: 'http://my-service-domain.com/icon.png',
  clientId: process.env.CLIENT_ID,
  operator: process.env.OPERATOR_URL,
  jwksPath: '/jwks',
  eventsPath: '/events',
  clientKey: process.env.PRIVATE_KEY,
  keyValueStore: keyValueStore,
  defaultPermissions: [
    {
      area: 'baseData',
      types: ['READ', 'WRITE'],
      purpose: 'Purpose of requesting permission.',
      description: 'Short description of requested permission.'
    }
  ]
}

// Create the Client which will be used all communication with Egendata Operator.
client.create(config)
</code></pre>

<h2 id="client-configuration-properties">Client configuration properties</h2>

<table>
<thead>
<tr>
<th>Configuration property</th>
<th>Data type</th>
<th>Purpose</th>
</tr>
</thead>

<tbody>
<tr>
<td><code>displayName</code></td>
<td><code>string</code></td>
<td><em>Name of this service/application</em></td>
</tr>

<tr>
<td><code>description</code></td>
<td><code>string</code></td>
<td><em>A short description of this Service</em></td>
</tr>

<tr>
<td><code>iconURI</code></td>
<td><code>string</code></td>
<td><em>A URI to this service&rsquo;s logotype/icon</em></td>
</tr>

<tr>
<td><code>clientId</code></td>
<td><code>string</code></td>
<td><em>This is the identifier which this service will use to identify/register itself to the Operator with. Typically this will be the public <code>https://domain:port</code> this service is hosted on</em></td>
</tr>

<tr>
<td><code>operator</code></td>
<td><code>string</code></td>
<td><em>This is field specifies the <code>https://domain:port</code> to the central Operator service.</em></td>
</tr>

<tr>
<td><code>jwksPath</code></td>
<td><code>string</code></td>
<td><em>This field specifies where this service&rsquo;s JWKS is exposed/found, e.g. <code>/jwks</code></em></td>
</tr>

<tr>
<td><code>clientKey</code></td>
<td><code>string</code></td>
<td><em>This field specifies the private key(<code>PEM</code>/<code>JWK</code>) this service will use for encrypting- and signing of data.</em></td>
</tr>

<tr>
<td><code>keyValueStore</code></td>
<td><code>object</code></td>
<td><em>A reference to an object/adapter which can read, write and remove data to/from a storage. The keyValueStore must implement the following interface: <code>keyValueStore.save(key, value, ttl)</code>, <code>keyValueStore.load(key)</code> and <code>keyValueStore.remove(key)</code>.</em></td>
</tr>

<tr>
<td><code>defaultPermissions</code></td>
<td><code>array</code></td>
<td><em>An array of desired read/write permissions</em></td>
</tr>

<tr>
<td><code>defaultPermissions.#.area</code></td>
<td><code>string</code></td>
<td><em>An area describes where in the user&rsquo;s PDS to store/read data from, e.g. <code>baseData</code> or <code>experiences</code></em></td>
</tr>

<tr>
<td><code>defaultPermissions.#.types</code></td>
<td><code>array</code></td>
<td><em>An array that denotes which types of permissions are desired for this specific area. e.g. <code>['READ']</code>, <code>['WRITE']</code> or both <code>['READ', 'WRITE']</code></em></td>
</tr>

<tr>
<td><code>defaultPermissions.#.purpose</code></td>
<td><code>string</code></td>
<td><em>A short purpose description of why this service requests this specific read/write permission, e.g. <code>'In order to create a CV using our website.'</code></em></td>
</tr>

<tr>
<td><code>defaultPermissions.#.description</code></td>
<td><code>string</code></td>
<td>_A short description of the area this permission request relates to, e.g. <code>'Personal information.'</code></td>
</tr>
</tbody>
</table>

<h2 id="key-provider">Key Provider</h2>

<p>The KeyProvider class is responsible for keeping track of known keys and tokens.</p>

<p>A configuration object must be passed into the KeyProvider constructor upon initialization.
There are 5 configuration properties that affect the construction of the KeyProvider object.</p>

<ul>
<li><code>config.clientKey</code></li>
<li><code>config.keyValueStore</code></li>
<li><code>config.keyOptions</code></li>
<li><code>config.jwksURI</code></li>
<li><code>config.alg</code></li>
</ul>

<p>The <code>KeyProvider</code> will utilize the <code>keyValueStorage</code> property to read and write from/to an external storage. E.g. The Egendata Example-CV service provides an adapter for a locally hosted the Redis database. The <code>KeyProvider</code> assumes that three functions are defined in the referenced <code>KeyValueStore</code> object:</p>

<ul>
<li><code>keyValueStorage.save(key, value, ttl)</code></li>
<li><code>keyValueStorage.load(key)</code></li>
<li><code>keyValueStorage.remove(key)</code></li>
</ul>

<p>All values written by the KeyProvider to the external/referenced <code>KeyValueStore</code> are base64 encoded.</p>

<p>The Client signing key(aka. <code>clientKey</code>) is provided through the configuration parameter upon initialization of the <code>Client</code>. This client key is used for all signing done by this Client, however there are future ideas to implement different signing keys for different domains/areas and/or key rotation.</p>

<h2 id="key-value-store">Key Value Store</h2>

<p>In order to utilize the Egendata Client, one must first create a KeyValueStore object to be provided in the configuration to the Client constructor.</p>

<h3 id="interface-definition">Interface definition</h3>

<p>The following interface is expected to be implemented in the Service&rsquo;s KeyValueStore object.</p>

<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td><code>save(key, value, ttl)</code></td>
<td>&bull; <code>key</code>: The lookup key of which this saved record will be identified by in persistent storage.<br>&bull; <code>value</code>: The value to be stored in persistent storage.<br>&bull; <code>ttl</code>: The KeyValueStore must respect the specified TTL(Time to live) of the saved record, as such it must be automatically removed from storage upon TTL expiry.</td>
</tr>

<tr>
<td><code>load(key)</code></td>
<td>&bull; <code>key</code>: The lookup key a record to load and return back to caller.</td>
</tr>

<tr>
<td><code>remove(key)</code></td>
<td>&bull; <code>key</code>: The lookup key of which all associated record(s) shall permanently removed from persistent storage.</td>
</tr>
</tbody>
</table>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/docs/egendata-core/" title="Egendata Core"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/docs/egendata-core/data/" title="Data" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/docs/js/clipboard.min.js?1595422117"></script>
    <script src="/docs/js/perfect-scrollbar.min.js?1595422117"></script>
    <script src="/docs/js/perfect-scrollbar.jquery.min.js?1595422117"></script>
    <script src="/docs/js/jquery.sticky.js?1595422117"></script>
    <script src="/docs/js/featherlight.min.js?1595422117"></script>
    <script src="/docs/js/highlight.pack.js?1595422117"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/docs/js/modernizr.custom-3.6.0.js?1595422117"></script>
    <script src="/docs/js/learn.js?1595422117"></script>
    <script src="/docs/js/hugo-learn.js?1595422117"></script>

    <link href="/docs/mermaid/mermaid.css?1595422117" rel="stylesheet" />
    <script src="/docs/mermaid/mermaid.js?1595422117"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>
